<!DOCTYPE html>
<html>
  <head>
    <title><%= title %></title>
    <link rel='stylesheet' href='/stylesheets/style.css' />
    <link rel="stylesheet" href="http://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
    <script src="http://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.js"></script>
    <script src="http://code.jquery.com/jquery-1.10.2.js"></script>
  </head>
  <body>
    
    <div style="border:cornflowerblue 1px; background-color: #2C3E50; width: 100%; height: 20%; position: absolute;"></div>
    <div style="border:1px #ced4da solid; background-color: white; width:50%; height:70%; margin:0 auto; position: relative; top:100px">
      <h1 align="center"><b>註冊</b></h1>  
        <center><table   width='70%' height="300px" >
          <form>
            <tr>
              <td colspan="3"><div class="col-12"><input type="email" class="form-control" id="registeracc" name="registeracc" placeholder="電子郵件" required></div></td>
            </tr>
            <tr>
              <td><div class="col-12"><input type="text"  class="form-control" id="registername" name="registername" placeholder="姓名或暱稱" required></div></td>             
              <td colspan="2" align="center" >使用暱稱讓他人更知道你</td>
            </tr>
            <tr id='ch'>
              <td><div class="col-12"><input type="password"  class="form-control" id="registerpw" name="registerpw" placeholder="密碼" required></div></td>              
              <td><div class="col-12"><input type="password"  class="form-control" id="checkpw" name="checkpw" placeholder="確認" required></div></td>                      
              <td align="right"><span id="icon" class="glyphicon glyphicon-eye-close"></span></td>
            </tr>
            <tr>
              <td colspan="3">&nbsp;&nbsp;&nbsp;請混合使用8個字元以上的英文字母、數字和符號</td>
            </tr>
            <tr>
              <td colspan="3">&nbsp;&nbsp;&nbsp;<font color='red' id='message'></font></td>
            </tr>
            <tr>
              <td>&nbsp;&nbsp;&nbsp;已有帳戶?&nbsp;<a href="/login">登入</a></td>
              <td colspan="2" align="right"><input type="button"  class="btn btn-primary" style="width: 40%; background-color: #2C3E50;" id="btn" value="繼續"></td>
              
            </tr>
          </form>
        </table></center>
        <br>
    </div>


    <script>
      $("#btn").click(function() {
        
        var acc_id = $('#registeracc').val();
        var acc_name = $('#registername').val();
        var acc_pw = $('#registerpw').val();
        var chpw = $('#checkpw').val();
        if(!acc_id || !acc_name || !acc_pw || !chpw) {
          $('#message').text("輸入未填欄位");
        }
        else if(acc_pw != chpw) {
          $('#message').text("密碼不一樣");
        }
        else{
          $.ajax({
            url:"/register",
            data:{'account': acc_id, 'name': acc_name, 'password': acc_pw},
            type:"POST",
            success: function(res){
              if(res.status == 1) {
                $('#message').text(res.msg);
              }
              else{
                location.href = '/'
              }

            }
          })
          
        }
        
      })

      
      $("#icon").click(function() {
        if($('input[name=checkpw]').attr("type")== "password") {//當隱藏密碼時
          $('input[name=registerpw]').prop('type', 'text');
          $('input[name=checkpw]').prop('type', 'text');
          $('#icon').removeClass('glyphicon-eye-close').addClass('glyphicon-eye-open');
        }
        else {
          $('input[name=registerpw]').prop('type', 'password');
          $('input[name=checkpw]').prop('type', 'password');
          $('#icon').removeClass('glyphicon-eye-open').addClass('glyphicon-eye-close');
        }       
        
      })
    </script>
  </body>
</html>